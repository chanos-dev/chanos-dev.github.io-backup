I"î<h2 id="list-collection-tolist"><center>List Collection ToList()</center></h2>

<blockquote>
  <p><a href="https://github.com/chanos-dev/blogcode/tree/master/21-0617">Git Source</a></p>
</blockquote>

<hr />

<p>ìš°ì„ , í•„ìëŠ” List í´ë˜ìŠ¤ì—ì„œ ToList í™•ì¥ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ í•´ë‹¹ ê°ì²´ ë° í•˜ìœ„ ì—˜ë¦¬ë©˜íŠ¸ë“¤ì´ ëª¨ë‘ Deep Copyê°€ ë˜ëŠ”ì§€ ì•Œì•˜ëŠ”ë° ê·¸ê²Œ ì•„ë‹ˆì˜€ë‹¤. ğŸ˜¥</p>

<p>í•˜ì§€ë§Œ ToListì—ì„œ ë¦¬í„´ëœ ê°ì²´ì—ì„œ ê°’ì„ ìˆ˜ì •í•˜ë‹ˆ ì›ë³¸ ê°ì²´ì˜ ê°’ë„ ìˆ˜ì •ì´ëœ ê²ƒì„ í™•ì¸í–ˆë‹¤.</p>

<p>í•´ë‹¹ ToList()ë¥¼ ë””ì»´íŒŒì¼ëŸ¬ë¡œ í™•ì¸ì„ í•´ë³¸ ê²°ê³¼ ë‹¤ìŒê³¼ ê°™ì•˜ë‹¤.</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">static</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">TSource</span><span class="p">&gt;</span> <span class="n">ToList</span><span class="p">&lt;</span><span class="n">TSource</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">TSource</span><span class="p">&gt;</span> <span class="n">source</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">source</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">?</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">TSource</span><span class="p">&gt;(</span><span class="n">source</span><span class="p">)</span> <span class="p">:</span> <span class="k">throw</span> <span class="n">Error</span><span class="p">.</span><span class="nf">ArgumentNull</span><span class="p">(</span><span class="k">nameof</span> <span class="p">(</span><span class="n">source</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="nf">List</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">collection</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">collection</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
    <span class="n">ThrowHelper</span><span class="p">.</span><span class="nf">ThrowArgumentNullException</span><span class="p">(</span><span class="n">ExceptionArgument</span><span class="p">.</span><span class="n">collection</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">collection</span> <span class="k">is</span> <span class="n">ICollection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">objs</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">count</span> <span class="p">=</span> <span class="n">objs</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">_items</span> <span class="p">=</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;.</span><span class="n">_emptyArray</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">_items</span> <span class="p">=</span> <span class="k">new</span> <span class="n">T</span><span class="p">[</span><span class="n">count</span><span class="p">];</span>
            <span class="n">objs</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_items</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="n">_size</span> <span class="p">=</span> <span class="n">count</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_size</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_items</span> <span class="p">=</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;.</span><span class="n">_emptyArray</span><span class="p">;</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="n">T</span> <span class="n">obj</span> <span class="k">in</span> <span class="n">collection</span><span class="p">)</span>
            <span class="k">this</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ToListë¥¼ í˜¸ì¶œí•˜ë©´ ê²°êµ­ List ìƒì„±ìë¥¼ í˜¸ì¶œí•˜ëŠ”ë° ë‚´ë¶€ ë¡œì§ì„ ì‚´í´ë³´ë©´ ë‚´ë¶€ í•„ë“œì¸  _itemsì— CopyToë¥¼ í•´ì£¼ê³  ìˆë‹¤.</p>

<p>CopyTo ë©”ì„œë“œë„ ê²°êµ­ì—ëŠ” <code class="language-plaintext highlighter-rouge">ICollection</code> ì¸í„°í˜ì´ìŠ¤ë¡œ ì •ì˜ëœ List.CopyToê°€ í˜¸ì¶œë˜ëŠ”ë°, ì´ ì•ˆì—ì„œ Array.Copy()ë¥¼ í˜¸ì¶œí•´ì¤€ë‹¤.</p>

<p>ì—¬ê¸°ì„œ Array.Copyë¥¼ í•˜ë©´ MSDN ê³µì‹ë¬¸ì„œì— Deep Copyê°€ ì•„ë‹Œ Shallow Copyê°€ ì´ë£¨ì–´ì§„ë‹¤ê³  ì„¤ëª…ì´ ë‚˜ì™€ìˆë‹¤.</p>

<p>ê·¸ë ‡ê¸° ë•Œë¬¸ì— ToListë¡œ ë°›ì•„ì˜¨ ê°ì²´ì—ì„œ ìˆ˜ì •ì„í•˜ë©´ ì›ë³¸ë„ ìˆ˜ì •ì´ ë˜ëŠ” ê²ƒ..</p>

<p>ë¬´ì—‡ë³´ë‹¤ List í´ë˜ìŠ¤ê°€ Linked Listë¡œ êµ¬í˜„ëœì¤„ ì•Œì•˜ì§€ë§Œ Arrayë¥¼ ê°–ê³  ì»¨íŠ¸ë¡¤ì„ í•˜ê³  ìˆì—ˆë‹¤ëŠ” ì ì´ë‹¤. Listì˜ ì¶”ê°€ ë° ì‚­ì œê°€ ì´ë£¨ì–´ì§ˆ ë•Œë§ˆë‹¤ Array.Copyê°€ ì´ë£¨ì–´ì§€ê¸° ë•Œë¬¸ì— í° ê°ì²´ë¥¼ ë‹´ê³  ìˆê±°ë‚˜ ë§ì€ ê°ì²´ê°€ ìˆëŠ” ê²½ìš° ê·¸ì— ë”°ë¥¸ ë¹„ìš©ì´ ì»¤ì§ˆ ìœ„í—˜ì´ ìˆì„ ê²ƒ ê°™ë‹¤.</p>

<hr />

<h2 id="reference">Reference</h2>

<p><a href="https://docs.microsoft.com/ko-kr/dotnet/api/system.array.copy?view=net-5.0" target="_blank">Array.Copy ë©”ì„œë“œ</a></p>
:ET